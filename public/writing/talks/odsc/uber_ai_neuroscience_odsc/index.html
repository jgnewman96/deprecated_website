<!DOCTYPE html>
<html lang="en-us">
    <head>
        

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>AI Neuroscience: Can we understand the neural networks we train?</title>
        
        <style>

    html body {
        font-family: 'Ubuntu', sans-serif;
        background-color: white;
    }

    :root {
        --accent: darkgreen;
        --border-width:  5px ;
    }

</style>


<link rel="stylesheet" href="https://judahgnewman.netlify.com/css/main.css">





<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu">


 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"> 


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
 

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/go.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/haskell.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/kotlin.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/scala.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/swift.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js"></script>
    
    <script>hljs.initHighlightingOnLoad();</script>






<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


<script>$(document).on('click', function() { $('.collapse').collapse('hide'); })</script>
 <meta name="generator" content="Hugo 0.59.1" />
        

        

        
            <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        

        

    </head>

    <body>
        

        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand visible-xs" href="#">AI Neuroscience: Can we understand the neural networks we train?</a>
                    <button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
                <div class="collapse navbar-collapse">
                    
                        <ul class="nav navbar-nav">
                            
                                <li><a href="/">Home</a></li>
                            
                                <li><a href="/about/">About</a></li>
                            
                                <li><a href="/writing/">Writing</a></li>
                            
                                <li><a href="/reading/">Reading</a></li>
                            
                                <li><a href="/research/">Research</a></li>
                            
                        </ul>
                    
                    
                        <ul class="nav navbar-nav navbar-right">
                            
                                <li class="navbar-icon"><a href="mailto:judah.newman@gmail.com"><i class="fa fa-envelope-o"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://github.com/jgnewman96/"><i class="fa fa-github"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://www.linkedin.com/in/jgnewman96/"><i class="fa fa-linkedin"></i></a></li>
                            
                        </ul>
                    
                </div>
            </div>
        </nav>


<main>

    <div>
        <h2>AI Neuroscience: Can we understand the neural networks we train?</h2>
        <h5></h5>
        
<a href="https://judahgnewman.netlify.com/tags/deep-learning"><kbd class="item-tag">Deep Learning</kbd></a>


<a href="https://judahgnewman.netlify.com/categories/talks"><kbd class="item-category">Talks</kbd></a>

    </div>

    <div align="start" class="content">

<p>Talk given by <a href="http://yosinski.com/">Jason Yosinski</a>. He works at Uber AI Labs and Recursion Pharmaceuticals</p>

<h2 id="motivation">Motivation</h2>

<p>We train and use neural netwroks but we have a very minimal grasp on how they actual work. We have created systems that can beat humans players in games and actually create robots that can work. We have made huge advances in creating systems that can do impressive things. Most of the this improve has been driven by increase in computation and increase in amounts of data. Yet, scientific understaning is not connected to progress. When a computer becomes two times faster, that does not mean we understand it twice as much.</p>

<p>Currently we are building models that are more powerful than we can understand. Often we build things that are more complex than we can understand. But understanding falling two far behind what we do is dangerous. We need to work hard to keep our understanding closer to our progress.</p>

<hr />

<p>Lets look at our understanding of a deep learning system. Alex Net was one of the first breakthrough networks in computer vision. At this point we can define the code for Alex Net in about ten lines of keras code. We define the size of the layers and the Relu between them. But this code is not actually the model itself, it is the skeleton of the model. The model consists of the actual matrices. Our model consists of the 60 million numbers that are in our matrices. It turns out then when we have all of the right numbers in the right places, these matrices can accomplish some pretty incredible things.</p>

<p>For the example of Alex Net, we understand the outer most part of the system. The input is image which is a bunch of pixels. The output is a classification of what is in the image. The difficulty comes from understanding the middle of the network. We can begin to understand the network by feeding images through the network and seeing what happens. We can plot the different parts of the network.</p>

<p>Jason developed a <a href="http://yosinski.com/deepvis">visualization toolkit</a> that allows you to visualize how a neurel net is being activated when you feed an image through it. Jason during the talk demoed this tool to help us understand how the neurel net works. He showed how the first layer understand the lowest level of abstraction. So a transition from white to dark or essentially and edge. Then as we go further down the network we get to higher and higher levels of abstraction. SO one layer might have a detector for faces or for text.</p>

<p>The very first layer looks for patterns in pixel space. Then the second layer looks for patterns in the previous layer, not the pixel layer. By stacking these layers we slowly see more and more patterns. The first layer sees patters in an 11 x 11 pixel box. The second layer than has a 3 x 3 filter so it can see patterns in a 33 x 33 pixel space. Here is an <a href="https://medium.com/@smallfishbigsea/a-walk-through-of-alexnet-6cbd137a5637">article</a> that outlies Alexnet&rsquo;s architecture for reference.</p>

<p>So now that we understand to some extent what it learns, can we understand why it learns these features. We neved told the system to learn faces or text or edges. We told it to learn how to classify pictures. We can conjecture that it learns these different abstractions because without them, it cannot accomplish the task we want it to.</p>

<p>Imagine a seatbelt. A seatbelt is nothing but a grey stripe. But there are grey stripes everywhere. So it cannout just learn, grey stripe, otherwise it would classify so many things as a seatbelt. It had to learn that a seatbelt is gray stripe beneath a face. It is learning to detect a face, because that is an abstraction that will help it detect many other things. Or imagine a camera lense. If the system called everything that was a black circle a camera lens it would not be succesfuully. It should only label a black circle with text in the middle a camera lens.</p>

<p>Using this visualization tool we were able to understand a little about the middle layers of Alex Net. But we only looked at couple of neurons. It would take so long to understand one feature decoder. Understanding all of the neurons would take forver.</p>

<hr />

<p>After publishing the paper on all of these findings, Jason was frustrated but entraced. We had improved our understanding of the system to some degree, but there still was so much to learn. He decided to try a different approach. Rather than passing a photo through a network and inspecting the neurons, lets ask a network what it thinks a guerilla is. We could start with a photo of white noice and feed it through the network. We could then slowly update the photo so that the network assigns a high probability of it being a guerilla. So at first it would have no idea what the photo was. Then we would back propogate through to the photo so that it thought it was more a guerilla. If we do this many times eventually the network will think it is a guerilla with very high probability and this should give us some understanding of what the network believes is a guerilla.</p>

<p>But when they did this, they did not get a photo that looks anything like a guerilla. Yet the network says with very high probability it is a guerilla. He then wrote a paper about why this approach failed. It is great that in science when something fails it is a paper. In engineering when somethings fails, then you failed.</p>

<p>The next approach was to try the same thing but regularize the image space so no pixels are too extreme. Also make it so pixels do not change too quickly. They combined a bunch of regularizers (l1, l2, and spatial smoothness) and started getting better results. He showed examples with a hartebeast and a school bus. For the hartebeeast the networks does not learn hooves, because lots of animals have hooves. It does learn the horns and the shape of the top of the hartebeast are what defines a hartebeast. For a school buss it learns to look for patterns of yellow and windows and wheels.</p>

<p>Know we kind of have an understanding of the network is learning. The regularizer allowed us to enfore a prior to keep images in a specific region.</p>

<hr />

<p>Rather than using regularization though, we can use GANS. One network that determines whether or a not an image looks real and then another network that says does it look like a specific class. We then are also changing the input from being a specic class to being a caption.</p>

<p>What if we wanted to replace a network with a brain? We could then see how the brain work using a similar process. Unfortunately we cannot do back propogation through a brain.</p>

<p>But a group in harvard and Japan did something similar with Monkeys. They showed monkeys a blank image and then saw what neurons fired. They then altered that photo to make it excite those neurons even more. They did this iteratively until eventually they created a photo that looked like a monkey. The monkey was trying to recognize another monkey.</p>

<hr />

<p>There must recent research is about trying to to understand what is happening during the training process. When we train an algorithm all we see is that the loss is going down. But what does that actually mean? We want to understand how is the network actually changing.</p>

<p>There must recent paper <a href="https://arxiv.org/abs/1909.01440">LCA: loss change allocation for neurel network training</a> does exactly that. They examine the matrices over time to see how they are changing during the training process. It provides a rich visuilizations of how each neuron is changing.</p>

<p>They take away three things from this visualization.</p>

<ol>
<li>Training is very noisy with different neurons going in different directions</li>
<li>It seems like some layers actually make the loss worse</li>
<li>There seems to be some levels of micro learning that is snychronized with nearby neurons being updated in similar ways.</li>
</ol>

<p>This visualization gives us much more visibility into what is happening during training.</p>

<h2 id="my-thoughts">My thoughts</h2>

<p>Wow this was a really cool talk. I especially loved the iterative process of the research. We are interested in something, lets look at it and try and understand it. Okay, now that we have improved our understanding a little bit what are the next steps.</p>

<p>The idea that some of the neurons or layers are actually hurting the model in terms of loss is really odd to me. I am not sure what to make of that. The way Jason explained it was that it was because they were losing out to other layers. If we knew that one layer was hurting the model in terms of loss could we improve it by removing that layer?</p>

<p>I am interested in how some of these visualizations, both the most recent ones about the training process and the ones used to visualize a trained model, could be used to improve the model training process. Is it possible that by providing these with end-users and them having a better understanding of the model is working we could improve the model building process. COuld we use these tools to better understand errors. If we look at an error and use this tool could we understand why the model is making an error and help make the model more robust?</p>
</div>


    
    <script src="https://utteranc.es/client.js" repo="jgnewman96/website" issue-term="title" theme="github-light"
    crossorigin="anonymous" async>
    </script>
    


</main>





<footer>
    <p class="copyright text-muted">
        &copy; All rights reserved. Powered by <a href="https://gohugo.io">Hugo</a> and <a href="https://github.com/calintat/minimal">Minimal</a>.
    </p>
</footer>



</body>


</html>